<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="A layout example that shows off a blog page with a list of posts.">

    <title>Umfrage: Stadtentwicklung Limmattal</title>

    


<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css">



<!--[if lte IE 8]>
  
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-old-ie-min.css">
  
<![endif]-->
<!--[if gt IE 8]><!-->
  
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css">
  
<!--<![endif]-->





  
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="/static/css/layouts/blog-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="/static/css/layouts/blog.css">
    <!--<![endif]-->
  
    <link href="/static/css/jquery.nouislider.css" rel="stylesheet">
    <link href="/static/css/jquery.nouislider.pips.min.css" rel="stylesheet">

    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script> 
    <script src="/static/js/jquery.nouislider.all.min.js"></script>

    <script type="text/javascript">
      goals = [
       {
        'key': 'natres',
        'desc': 'F&ouml;rderung nat&uuml;rlicher Ressourcen'
       },
       {
        'key': 'pubtrans',
        'desc': 'F&ouml;rderung des &ouml;ffentlichen Verkehrs'
       },
       {
        'key': 'habitat',
        'desc': 'Steigerung der Lebensraumqualit&auml;t'
       },
       {
        'key': 'housing',
        'desc': 'Verbesserung der Siedlungskultur'
       }
      ];
	  
	  random_inconsistency_indices = [0.00,
		  0.00, 0.00, 0.58, 0.90, 1.12,
		  1.24, 1.32, 1.41, 1.45, 1.49,
		  1.51, 1.48, 1.56, 1.57, 1.59
	  ];

      matrix = {
        'abs': [],
        'norm': []
      };
      for (var i = 0; i < goals.length; i++) {
        matrix['abs'][i] = [];
        matrix['norm'][i] = [];
        matrix['abs'][i][i] = 1;
        matrix['norm'][i][i] = 1;
      }

      weights = [];
      consistency_vector = [];
	  consistency_ratio = undefined;

      function populate_matrix() {
        for (var i = 0; i < goals.length; i++) {
          for (var j = i + 1; j < goals.length; j++) {
            val = $('input[name="' + goals[i].key + '_' + goals[j].key + '"]').val();
            matrix['abs'][i][j] = val;
            matrix['abs'][j][i] = 1/val;
          }
        }
      }

      function normalize_matrix() {
        var col_sums = [];
        for (var j = 0; j < goals.length; j++) {
          col_sums[j] = 0.0;
          for (var i = 0; i < goals.length; i++) {
            col_sums[j] += +matrix['abs'][i][j];
          }
        }

        for (var i = 0; i < goals.length; i++) {
          for (var j = 0; j < goals.length; j++) {
            matrix['norm'][i][j] = matrix['abs'][i][j]/col_sums[j];
          }
        }
      }

      function compute_weights() {
        for (var i = 0; i < goals.length; i++) {
          weights[i] = 0;
          for (var j = 0; j < goals.length; j++) {
            weights[i] += +matrix['norm'][i][j];
          }
		  weights[i] /= +goals.length;
        }
      }

      function compute_consistency_vector() {
        for (var i = 0; i < goals.length; i++) {
          consistency_vector[i] = 0;
          for (var j = 0; j < goals.length; j++) {
            consistency_vector[i] += matrix['abs'][i][j] * weights[j];
          }
		  consistency_vector[i] /= weights[i];
        }
      }
	  
	  function compute_consistency_ratio() {
		  var lambda = 0;
		  for (var i = 0; i < consistency_vector.length; i++) {
			  lambda += +consistency_vector[i];
		  }
		  lambda /= consistency_vector.length;
		  
		  consistency_index = (lambda - goals.length) / (goals.length - 1);
		  
		  consistency_ratio = consistency_index / random_inconsistency_indices[goals.length];
	  }

      function get_matrix() {
	var table = $('<table border="1"></table>');

        var headers = $('<tr></tr>');
        table.append(headers);
        headers.append($('<th></th>')); // left column
        for (var i = 0; i < goals.length; i++) {
          headers.append($('<th>' + goals[i].key + '</th>'));
        }

        for (var i = 0; i < goals.length; i++) {
          row = $('<tr></tr>');
          row.append($('<th>' + goals[i].key + '</th>'));
          for (var j = 0; j < goals.length; j++) {
            row.append($('<td>' + matrix['abs'][i][j] +
             ' / <b>' + matrix['norm'][i][j] + '</b></td>'));
          }
          table.append(row);
        }

        row = $('<tr></tr>');
        row.append($('<th>weights</th>'));
        for (var i = 0; i < weights.length; i++) {
          row.append($('<td>' + weights[i] + '</td>'));
        }
        table.append(row);

        row = $('<tr></tr>');
        row.append($('<th>consistency_vectory</th>'));
        for (var i = 0; i < consistency_vector.length; i++) {
          row.append($('<td>' + consistency_vector[i] + '</td>'));
        }
        table.append(row);
		
		row = $('<tr></tr>');
		row.append($('<th>consistency_ratio</th>'));
		row.append($('<td colspan="' + goals.length +'">' + consistency_ratio + '</td>'));
		table.append(row);

        return table;
      }

      function debug() {
       populate_matrix();
       normalize_matrix();
       compute_weights();
       compute_consistency_vector();
	   compute_consistency_ratio();
       $('#debug').empty().append(get_matrix());
      }

      $(document).ready(function () {

      // append goals
      for (var i = 0; i < goals.length; i++) {
        for (var j = i + 1; j < goals.length; j++) {
         $("#fields").append('<div class="pure-g">' +
                             ' <div class="pure-u-1-3">' + goals[i].desc + '</div>' +
                             '  <div class="pure-u-1-3">' +
                             '   <div class="slider" id="' + goals[i].key + '_' + goals[j].key + '"></div>' +
                             '  </div>' +
                             ' <div class="pure-u-1-3" style="text-align: right">' + goals[j].desc + '</div>' +
                             '</div>');
        }
      }
                       

       // init sliders
       $('.slider').each(function() {
         var id = $(this).attr('id');
         $(this).noUiSlider({
           start: [1],
           range: {
            'min':     [ 1/9 ],
            '6.25%':   [ 1/8 ],
            '12.5%':   [ 1/7 ],
            '18.75%':  [ 1/6 ],
            '25%':     [ 1/5 ],
            '31.25%':  [ 1/4 ],
            '37.5%':   [ 1/3 ],
            '43.75%':  [ 1/2 ],
            '50%':     [ 1 ],
            '56.25%':  [ 2 ],
            '62.5%':   [ 3 ],
            '68.75%':  [ 4 ],
            '75%':     [ 5 ],
            '81.25%':  [ 6 ],
            '87.5%':   [ 7 ],
            '93.75%':  [ 8 ],
            'max':     [ 9 ], 
           },
           direction: "rtl",
           format: wNumb({decimals: 6}),
           snap: true
         });
         $(this).Link('lower').to(id);
         $(this).css('margin-bottom', '40px');
       });

       $('.slider').noUiSlider_pips({
         mode: 'positions',
         values: [0, 6.25, 12.5, 18.75, 25, 31.25, 37.25, 43.75, 50, 56.25, 62.5, 68.75, 75, 81.25, 87.5, 93.75, 100],
         density: 8,
         filter: function(value, type) { return 0; }
       });
      });
    </script>

</head>
<body>







<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
        <div class="header">
            <h1 class="brand-title">Umfrage</h1>
            <h2 class="brand-tagline">Stadtentwicklung Limmattal</h2>
            <hr/>
            <p>Noemi Neuenschwander</p>
            <p>Eidgenössische Technische Hochschule Zürich</p>

	<!--
            <nav class="nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a class="pure-button" href="http://purecss.io">Pure</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="http://yuilibrary.com">YUI Library</a>
                    </li>
                </ul>
            </nav>
	-->
        </div>
    </div>

    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            <!-- A wrapper for all the blog posts -->
            <div class="posts">
                <h1 class="content-subhead">Stadtentwicklung Schlieren &ndash; Dietikon</h1>

                <!-- A single blog post -->
                <section class="post">

                    <div class="post-description">
                         <form class="pure-form" action="/save/" method="get">
                          <fieldset id="fields">
                          <!--
                           <div class="pure-g">
                            <div class="pure-u-1-3">Förderung natürlicher Resourcen</div>
                            <div class="pure-u-1-3">
                              <div class="slider" id="natres_pubtrans"></div>
                            </div>
                            <div class="pure-u-1-3" style="text-align: right">Förderung des öffentlichen Verkehrs</div>
                           </div>
                           <hr/>
                           <div class="pure-g">
                            <div class="pure-u-1-3">Förderung natürlicher Resourcen</div>
                            <div class="pure-u-1-3">
                             <div class="slider" id="natres_habitat"></div>
                            </div>
                            <div class="pure-u-1-3" style="text-align: right">Steigerung der Lebensraumqualität</div>
                           </div>
                           <hr/>
                           <div class="pure-g">
                            <div class="pure-u-1-3">Förderung natürlicher Resourcen</div>
                            <div class="pure-u-1-3">
                             <div class="slider" id="natres_housing"></div>
                            </div>
                            <div class="pure-u-1-3" style="text-align: right">Verbesserung der Siedlungskultur</div>
                           </div>
                          -->
                          </fieldset>
                           <input type="submit" class="pure-button pure-button-primary" value="Submit">
                         </form>
                         <input type="button" value="debug" onclick="debug()"/>
                         <div id="debug"></div>
                    </div>
                </section>
            </div>


            <div class="footer">
                <div class="pure-menu pure-menu-horizontal pure-menu-open">
                    <ul>
                        <li><a href="http://purecss.io/">About</a></li>
                        <li><a href="http://twitter.com/yuilibrary/">Twitter</a></li>
                        <li><a href="http://github.com/yahoo/pure/">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>






</body>
</html>
